<!doctype html>
<html>
<head>
  {% include 'head_includes.html' %}
  <meta charset="utf-8"><title>Register</title>
</head>
<body class="p-4">
    {% include 'navbar.html' %}
  <h1>Register</h1>
  <form method="post">
    <div class="mb-3"><label>Username</label><input class="form-control" name="username" required></div>
    <div class="mb-3"><label>Email</label><input class="form-control" name="email" type="email" required></div>
    <div class="mb-3">
      <label for="password">Password</label>
      <input id="password" class="form-control" name="password" type="password" required aria-describedby="pwHelp">
      <div id="pwHelp" class="form-text">Choose a strong password (min 8 characters, mix of letters, numbers, symbols).</div>
      <div id="pwStrength" class="mt-2">
        <div class="progress" style="height:10px;">
          <div id="pwBar" class="progress-bar" role="progressbar" style="width:0%"></div>
        </div>
        <div id="pwFeedback" class="small mt-1 text-muted"></div>
        <ul id="pwChecklist" class="small mt-1 mb-0" style="list-style:none;padding-left:0">
          <li id="pw_len">• At least 8 characters</li>
          <li id="pw_upper">• Uppercase letter</li>
          <li id="pw_lower">• Lowercase letter</li>
          <li id="pw_digit">• Number</li>
          <li id="pw_special">• Symbol (e.g. !@#)</li>
        </ul>
      </div>
    </div>
    <button class="btn btn-primary">Register</button>
  </form>
  <script src="{{ url_for('static', filename='js/password_strength.js') }}"></script>
  <p class="mt-2">Already have an account? <a href="{{ url_for('login') }}">Login</a></p>
  {% with pw_msgs = get_flashed_messages(category_filter=['register_error']) %}
    {% if pw_msgs %}
      <!-- Password error modal -->
      <div class="modal fade" id="pwErrorModal" tabindex="-1" aria-labelledby="pwErrorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="pwErrorModalLabel">Password invalid</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p>The password you entered did not meet the requirements:</p>
              <ul>
                {% for m in pw_msgs %}
                  <li>{{ m }}</li>
                {% endfor %}
              </ul>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      <script>
        document.addEventListener('DOMContentLoaded', function(){
          var modal = new bootstrap.Modal(document.getElementById('pwErrorModal'));
          modal.show();
        });
      </script>
    {% endif %}
  {% endwith %}
  {% include 'footer.html' %}
</body>
</html>